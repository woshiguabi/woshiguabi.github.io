webpackJsonp([1,2],{38:function(t,e,i){"use strict";e.a={bombCount:50,row:20,col:20,maxRow:100,maxCol:100,theme:"classic",cellClassName:{isFlag:"flag fa-flag",status0:"status0",isBomb:"bomb fa-bomb",bombCount:"bomb-count-",bombCount0:"bomb-count-0"},cellDisplayText:{isFlag:"",status0:"",isBomb:"",bombCount:"",bombCount0:""}}},39:function(t,e,i){"use strict";var n=i(37),o=i.n(n),s={};Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,n=arguments[1],o=n>>0,s=o<0?Math.max(i+o,0):Math.min(o,i),a=arguments[2],r=void 0===a?i:a>>0,c=r<0?Math.max(i+r,0):Math.min(r,i);s<c;)e[s]=t,s++;return e}}),s.randomBomb=function(t,e){console.time("random"),t>e&&(t=e);var i=Array(e).fill(!1),n=Array(t).fill(1).map(function t(){var n=~~(Math.random()*e);return i[n]?t():(i[n]=!0,n)}),s=new o.a;return n.forEach(function(t){return s.add(t)}),console.timeEnd("random"),s},s.getCellStatus=function(t,e){return e.isFlag?t.isFlag:0===e.status?t.status0:e.isBomb?t.isBomb:e.bombCount>0?t.bombCount+e.bombCount:t.bombCount0},e.a=s},40:function(t,e,i){i(49);var n=i(14)(i(92),i(44),null,null);t.exports=n.exports},42:function(t,e,i){var n=i(14)(i(93),i(46),null,null);t.exports=n.exports},43:function(t,e,i){i(51),i(50);var n=i(14)(i(94),i(45),"data-v-75f32dd9",null);t.exports=n.exports},44:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("game")],1)},staticRenderFns:[]}},45:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.config.theme},[i("vue-drr",{staticClass:"scoreboard",attrs:{w:180,h:180,r:0,resizeable:!1,rotatable:!1}},[i("h3",[t._v("计分板")]),t._v("\n    旗帜数量： "+t._s(t.flagCount)+" "),i("br"),i("br"),t._v("\n    分数： "+t._s(t.score)+"\n  ")]),t._v(" "),i("div",{staticClass:"game-config"},[i("form",{attrs:{action:""},on:{submit:function(e){e.preventDefault(),t.init(e)}}},[i("label",[t._v("行: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputRow,expression:"inputRow"}],attrs:{type:"number",min:"2",max:t.config.maxRow},domProps:{value:t.inputRow},on:{input:function(e){e.target.composing||(t.inputRow=e.target.value)},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),i("label",[t._v("列: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputCol,expression:"inputCol"}],attrs:{type:"number",min:"2",max:t.config.maxCol},domProps:{value:t.inputCol},on:{input:function(e){e.target.composing||(t.inputCol=e.target.value)},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),i("label",[t._v("雷的数量: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputBombCount,expression:"inputBombCount"}],attrs:{type:"number",min:"1",max:~~t.inputRow*~~t.inputCol-1},domProps:{value:t.inputBombCount},on:{input:function(e){e.target.composing||(t.inputBombCount=e.target.value)},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),i("button",{attrs:{type:"submit"}},[t._v("生成")])]),t._v(" "),t.showTips?i("div",{staticClass:"game-config-tips"},[t._v(t._s(t.tipsText))]):t._e()]),t._v(" "),i("table",{staticClass:"game",class:{"tips-open":t.showTips},attrs:{width:t.width},on:{click:t.handleClick,contextmenu:function(e){e.preventDefault(),t.handleRightClick(e)},dblclick:t.handleDblClick}},t._l(t.cellData,function(e,n){return i("tr",{key:n},t._l(e,function(t,e){return i("cell",{key:e,attrs:{row:t.row,col:t.col,isBomb:t.isBomb,status:t.status,isFlag:t.isFlag,bombCount:t.bombCount}})}))})),t._v(" "),t.gameOver?i("div",{staticClass:"gameover layer"},[i("div",[t._v("Game Over")]),t._v(" "),i("div",[t._v("你美丽了!")]),t._v(" "),i("div",{staticClass:"retry"},[i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.init(e)}}},[t._v("再试一次")])]),t._v(" "),i("div",{staticClass:"retry"},[i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.view(e)}}},[t._v("查看雷的位置")])])]):t._e(),t._v(" "),t.success?i("div",{staticClass:"success layer"},[i("div",[t._v("Win!")]),t._v(" "),i("div",[t._v("你成功了!")]),t._v(" "),i("div",{staticClass:"retry"},[i("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.init(e)}}},[t._v("我还要玩")])])]):t._e(),t._v(" "),t.viewBomb?i("div",{staticClass:"layer-transparent"}):t._e()],1)},staticRenderFns:[]}},46:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("td",{class:t.className},[t._v(t._s(t.display))])},staticRenderFns:[]}},49:function(t,e){},50:function(t,e){},51:function(t,e){},92:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(43),o=i.n(n);e.default={name:"app",components:{game:o.a}}},93:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(39),o=i(38);e.default={name:"cell",props:["row","col","isBomb","status","isFlag","bombCount"],computed:{display:function(){return n.a.getCellStatus(o.a.cellDisplayText,this)},className:function(){return n.a.getCellStatus(o.a.cellClassName,this)}}}},94:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(37),o=i.n(n),s=i(91),a=i.n(s),r=i(42),c=i.n(r),l=i(38),u=i(39),f=i(48),m=i.n(f),h=function(){return"ActiveXObject"in window?function(){var t=document.createEvent("MouseEvent");return t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t}:function(){return new MouseEvent("click",{button:0,bubbles:!0})}}();e.default={name:"game",components:{cell:c.a,"vue-drr":m.a},data:function(){return{config:a()({},l.a),gameOver:!1,cellData:[],showTips:!1,viewBomb:!1,width:0,flagCount:0,score:0,inputRow:l.a.row,inputCol:l.a.col,inputBombCount:l.a.bombCount,bombSet:new o.a,success:!1,tipsText:""}},mounted:function(){this.init()},computed:{cellCount:function(){return this.config.col*this.config.row}},watch:{score:function(t){if(t===this.cellCount-this.config.bombCount){var e=this;this.bombSet.forEach(function(t){var i=t%e.config.col,n=~~(t/e.config.col);e.cellData[n][i].isFlag=1}),this.$forceUpdate(),this.score=this.cellCount,this.flagCount=this.config.bombCount,this.success=!0}}},methods:{view:function(){this.gameOver=!1,this.viewBomb=!0;var t=this;this.bombSet.forEach(function(e){var i=e%t.config.col,n=~~(e/t.config.col);t.cellData[n][i].status=1}),this.$forceUpdate()},init:function(){return~~this.inputCol>this.config.maxCol||~~this.inputRow>this.config.maxRow?(this.tipsText="请勿作死设置过大行列！",this.showTips=!0,this.inputRow=this.config.row,this.inputCol=this.config.col,void(this.inputBombCount=this.config.bombCount)):(this.config.col=~~this.inputCol,this.config.row=~~this.inputRow,~~this.inputBombCount>=this.cellCount?(this.tipsText="雷的数量最大为格子数量减1",this.showTips=!0,void(this.inputBombCount=this.cellCount-1)):(this.config.bombCount=~~this.inputBombCount,this.showTips=!1,this.success=!1,this.gameOver=!1,this.viewBomb=!1,this.score=0,this.flagCount=0,this.width=41*this.config.col+1,void(this.cellData=this.initData())))},initData:function(){var t=this;this.bombSet=u.a.randomBomb(this.config.bombCount,this.config.col*this.config.row);var e=[];return console.time("map"),e=Array(this.config.row).fill(0).map(function(e,i){return Array(t.config.col).fill(0).map(function(e,n){return{status:0,isFlag:!1,row:i,col:n,isBomb:t.bombSet.has(i*t.config.col+n),bombCount:0,isTriggered:!1}})}),console.timeEnd("map"),e},fail:function(){this.gameOver=!0},handleClick:function(t){if("TD"===t.target.nodeName){var e=t.target.cellIndex,i=t.target.parentNode.rowIndex,n=this.cellData[i][e];if(0===n.status){var o=t.button;if(0===o&&!n.isFlag){if(n.status=1,n.isBomb)return this.$forceUpdate(),void this.fail();this.score++;var s=this.getAroundCell(i,e);if(n.bombCount=s.reduce(function(t,e){return t+(e.isBomb?1:0)},0),0===n.bombCount){var a=this.$el.querySelector("table"),r=this.$nextTick;n.isTriggered=!0,s.forEach(function(t){if(!t.isTriggered&&!t.isFlag&&1!==t.status){var e=h();r(function(){a.rows[t.row].cells[t.col].dispatchEvent(e)})}})}this.$forceUpdate()}}}},handleRightClick:function(t){if("TD"===t.target.nodeName){var e=t.target.cellIndex,i=t.target.parentNode.rowIndex,n=this.cellData[i][e];1!==n.status&&(n.isFlag?(this.flagCount--,n.isFlag=!1):(this.flagCount++,n.isFlag=!0),this.$forceUpdate())}},handleDblClick:function(t){if("TD"===t.target.nodeName){var e=t.target.cellIndex,i=t.target.parentNode.rowIndex,n=this.cellData[i][e];if(1===n.status){var o=this.$el.querySelector("table"),s=this.getAroundCell(i,e),a=this.$nextTick;n.isTriggered=!0,s.forEach(function(t){if(!t.isTriggered&&!t.isFlag&&1!==t.status){var e=h();a(function(){o.rows[t.row].cells[t.col].dispatchEvent(e)})}})}}},getAroundCell:function(t,e){var i=[t-1,t,t+1],n=[e-1,e,e+1],o=[],s=this;return i.forEach(function(i){n.forEach(function(n){i===t&&n===e||i<0||i>=s.config.row||n<0||n>=s.config.col||o.push(s.cellData[i][n])})}),o}}}},95:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(41),o=i(40),s=i.n(o);n.a.config.productionTip=!1,new n.a({el:"#app",render:function(t){return t(s.a)}})}},[95]);
//# sourceMappingURL=app.8505b68deb3a889bdcd1.js.map